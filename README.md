# Diary Bot üìù

[![CI](https://img.shields.io/github/actions/workflow/status/Maxim-Proskurin/Bot_tg_diary/ci.yml?branch=main&label=CI)](https://github.com/Maxim-Proskurin/Bot_tg_diary/actions)
[![codecov](https://img.shields.io/codecov/c/github/Maxim-Proskurin/Bot_tg_diary?label=coverage)](https://codecov.io/gh/Maxim-Proskurin/Bot_tg_diary)
[![code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)

> –ê–≤—Ç–æ—Ä: **–ú–∞–∫—Å–∏–º –ü—Ä–æ—Å–∫—É—Ä–∏–Ω**

---

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **Python 3.12+** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Å—Ç–∏–ª—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.
- **aiogram 3.x** ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Telegram Bot‚ÄØFramework (FSM, –∫–æ–º–∞–Ω–¥—ã, –∫–Ω–æ–ø–∫–∏, —Å–æ—Å—Ç–æ—è–Ω–∏—è).
- **SQLAlchemy 2.x (async)** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL.
- **PostgreSQL** ‚Äî —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∑–∞–º–µ—Ç–æ–∫.
- **alembic** ‚Äî –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—Å–æ–∑–¥–∞–Ω–∏–µ/–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü, –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã).
- **python‚Äëdotenv** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ `.env` (—Å–µ–∫—Ä–µ—Ç—ã, —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è).
- **poetry** ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è.
- **pytest, pytest‚Äëasyncio** ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞.
- **flake8, black** ‚Äî –ª–∏–Ω—Ç–∏–Ω–≥ –∏ –∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞.

---

## CI / CD

| –≠—Ç–∞–ø               | –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç                                           |
| ------------------ | -------------------------------------------------------- |
| **Lint & Format**  | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ `flake8` –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `black --check`. |
| **Tests**          | –ó–∞–ø—É—Å–∫ unit‚Äë—Ç–µ—Å—Ç–æ–≤ `pytest` —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º `pytest‚Äëcov`.    |
| **Build & Deploy** | (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ø—É–±–ª–∏–∫–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞/—Ä–µ–ª–∏–∑–∞.              |

CI –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ **GitHub Actions** (—Å–º. `.github/workflows/ci.yml`).

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

‚îú‚îÄ‚îÄ bot.py               # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ö–µ–Ω–¥–ª–µ—Ä–æ–≤, –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ handlers/            # —Ö–µ–Ω–¥–ª–µ—Ä—ã –¥–ª—è –∫–æ–º–∞–Ω–¥ (add, list, edit, delete, find, ...)
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py      # –∫–∞–∂–¥—ã–π —Ö–µ–Ω–¥–ª–µ—Ä –ø–æ—Å—Ç—Ä–æ–µ–Ω —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π FSM
‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îú‚îÄ‚îÄ models.py        # SQLAlchemy‚Äë–º–æ–¥–µ–ª–∏ (User, Note, ...)
‚îÇ   ‚îî‚îÄ‚îÄ session.py       # —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Å–µ—Å—Å–∏–∏
‚îú‚îÄ‚îÄ alembic/             # –º–∏–≥—Ä–∞—Ü–∏–∏ alembic (env.py, versions/*)
‚îú‚îÄ‚îÄ tests/               # unit‚Äë—Ç–µ—Å—Ç—ã –±–∏–∑–Ω–µ—Å‚Äë–ª–æ–≥–∏–∫–∏ –∏ —Ö–µ–Ω–¥–ª–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ .env.example         # –ø—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ pyproject.toml       # –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ poetry

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/Maxim-Proskurin/Bot_tg_diary.git
cd Bot_tg_diary

# 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ Poetry
pip install poetry
poetry install

# 3. –ö–æ–ø–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example [.env](VALID_FILE)
# ... –∑–∞–ø–æ–ª–Ω—è–µ–º —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –∏ —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î ...

# 4. –ó–∞–ø—É—Å–∫–∞–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –±–æ—Ç–∞
poetry run alembic upgrade head
poetry run python [bot.py](VALID_FILE)

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
poetry run pytest

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞
poetry run pytest --cov=handlers --cov=db --cov-report=term-missing

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –ª–∏–Ω—Ç–µ—Ä–æ–º
poetry run flake8

# –ê–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
poetry run black .


# –ø—Ä–∏–º–µ—Ä .env

BOT_TOKEN=–¢–≤–æ–π_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
DB_HOST=localhost
DB_PORT=5432
DB_USER_NAME=postgres
DB_PASSWORD=–ø–∞—Ä–æ–ª—å_–æ—Ç_–±–¥
DB_NAME=–∏–º—è_–±–¥
DATABASE_URL=postgresql+asyncpg://postgres:–ø–∞—Ä–æ–ª—å_–æ—Ç_–±–¥@localhost:5432/–∏–º—è_–±–¥
